<div align="right"><h4>–ó–∞–Ω—è—Ç–∏–µ 16, 17</br>DWH. –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö</br>
–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ</h4></div>

<div align="center"><h2>–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö –≤ Vertica</br>—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Data Build Tool (dbt)</h2></div>

***

<details><summary>–û–ø–∏—Å–∞–Ω–∏–µ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è</summary>

–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ: –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DWH –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –≤–∏—Ç—Ä–∏–Ω

–¶–µ–ª—å:
–í —ç—Ç–æ–º –î–ó –≤—ã —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ—Ç–µ —Å—Ö–µ–º—É –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é –≤–∏—Ç—Ä–∏–Ω—É

–¶–µ–ª—å: –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É –¥–∞–Ω–Ω—ã—Ö + –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é –≤–∏—Ç—Ä–∏–Ω—É –¥–∞–Ω–Ω—ã—Ö
–°–£–ë–î: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Vertica (Docker) –ª–∏–±–æ PostgreSQL (Docker) –ª–∏–±–æ BigQuery (GCP)
–î–∞—Ç–∞—Å–µ—Ç: –õ—é–±–æ–π –∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –∫—É—Ä—Å–µ: Boston Crimes, Chicago Taxi Trips, –ó–∞—Ö–≤–∞—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ Divolte, –ª–∏–±–æ –ª—é–±–æ–π –∏–∑ GCP Public Datasets)
Definition of Done: ‚Ä¢ DDL –æ–±—ä–µ–∫—Ç–æ–≤ ‚Ä¢ DML —à–∞–≥–æ–≤ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π ‚Ä¢ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö

</details>

---

<div align="center"><h3>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–∞–±–æ—á–µ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è</h3></div>

---

- –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è —è —Å—Ç–∞–ª –∏—Å–∫–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ `docker`-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å `Vertica` –∏ `dbt`
- —Ç–æ, —á—Ç–æ —è –Ω–∞—à–µ–ª –Ω–µ —Å–æ–≤—Å–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–æ –º–æ–∏–º –æ–∂–∏–¥–∞–Ω–∏—è–º, –≤–µ—Ä—Å–∏–∏ –±—ã–ª–∏ –Ω–µ —Å–æ–≤—Å–µ–º —Å–≤–µ–∂–∏–µ, –∞ –º–Ω–µ —Ö–æ—Ç–µ–ª–æ—Å—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –±–æ–ª–µ–µ-–º–µ–Ω–µ–µ –Ω–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- —Ç–∞–∫ –∫–∞–∫ —É `dbt` [–Ω–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞](https://docs.getdbt.com/docs/available-adapters) –∫ `Vertica` —è —Å—Ç–∞–ª –∏—Å–∫–∞—Ç—å –Ω–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –Ω–∞—à–µ–ª [–≤–æ—Ç —ç—Ç–æ—Ç –∞–¥–∞–ø—Ç–µ—Ä](https://github.com/mpcarter/dbt-vertica)
- –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞ —è —Ä–µ—à–∏–ª —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å `docker`-–æ–±—Ä–∞–∑—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
- –ø–æ–ª—É—á–∏–ª—Å—è –≤–æ—Ç —Ç–∞–∫–æ–π –ø—Ä–æ–¥—É–∫—Ç -> [radchenkoam/vertica-dbt-docker](https://github.com/radchenkoam/vertica-dbt-docker)
    (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –æ–ø–∏—Å–∞–Ω–∞ –≤ `readme` —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
    `Vertica` –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ –Ω–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å - 10.1.0-0, –∞–¥–∞–ø—Ç–µ—Ä `dbt-vertica` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–≤–æ–µ–º —Å–æ—Å—Ç–∞–≤–µ `dbt` –≤–µ—Ä—Å–∏–∏ 18.2
- –≤ —ç—Ç–æ–º –∂–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è [–ø—Ä–æ–µ–∫—Ç `dbt`](https://github.com/radchenkoam/vertica-dbt-docker/tree/main/dbt/crimes_in_boston) —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–∞—Ç–∞—Å–µ—Ç–∞ [Crimes in Boston](https://www.kaggle.com/AnalyzeBoston/crimes-in-boston)

---

<div align="center"><h3>Data Build Tool (dbt)</h3></div>

---

- –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `dbt` –≤—ã–ø–æ–ª–Ω–∏–ª –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö `dbt seed`:
```bash
$ dbt seed
Running with dbt=0.18.2
[WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.crimes_in_boston.offense_codes
- seeds.crimes_in_boston.crime

Found 6 models, 12 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 2 seed files, 0 sources

00:43:05 | Concurrency: 1 threads (target='dev')
00:43:05 | 
00:43:05 | 1 of 2 START seed file dbt.crime..................................... [RUN]
00:43:47 | 1 of 2 OK loaded seed file dbt.crime................................. [-1 in 42.46s]
00:43:47 | 2 of 2 START seed file dbt.offense_codes............................. [RUN]
00:43:47 | 2 of 2 OK loaded seed file dbt.offense_codes......................... [-1 in 0.06s]
00:43:47 | 
00:43:47 | Finished running 2 seeds in 42.77s.

Completed successfully

Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
```

- –≤—ã–ø–æ–ª–Ω–∏–ª –∫–æ–º–∞–Ω–¥—É —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π `dbt run`:
    ```bash
    $ dbt run
    Running with dbt=0.18.2
    [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
    There are 2 unused configuration paths:
    - seeds.crimes_in_boston.crime
    - seeds.crimes_in_boston.offense_codes
    
    Found 6 models, 13 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 2 seed files, 0 sources
    
    00:46:28 | Concurrency: 1 threads (target='dev')
    00:46:28 | 
    00:46:28 | 1 of 6 START view model dbt.stg_crime................................ [RUN]
    00:46:28 | 1 of 6 OK created view model dbt.stg_crime........................... [-1 in 0.09s]
    00:46:28 | 2 of 6 START view model dbt.stg_offense_codes........................ [RUN]
    00:46:28 | 2 of 6 OK created view model dbt.stg_offense_codes................... [-1 in 0.04s]
    00:46:28 | 3 of 6 START table model dbt.crimes.................................. [RUN]
    00:46:29 | 3 of 6 OK created table model dbt.crimes............................. [-1 in 1.21s]
    00:46:29 | 4 of 6 START table model dbt.mrt_offense_all_count................... [RUN]
    00:46:29 | 4 of 6 OK created table model dbt.mrt_offense_all_count.............. [-1 in 0.16s]
    00:46:29 | 5 of 6 START table model dbt.mrt_offense_by_year_count............... [RUN]
    00:46:29 | 5 of 6 OK created table model dbt.mrt_offense_by_year_count.......... [-1 in 0.18s]
    00:46:29 | 6 of 6 START table model dbt.mrt_offense_by_year_month_count......... [RUN]
    00:46:30 | 6 of 6 OK created table model dbt.mrt_offense_by_year_month_count.... [-1 in 0.19s]
    00:46:30 | 
    00:46:30 | Finished running 2 view models, 4 table models in 2.04s.
    
    Completed successfully
    
    Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
    ```

    - –≤—ã–ø–æ–ª–Ω–∏–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π `dbt test`:
```bash
$ dbt test
Running with dbt=0.18.2
[WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.crimes_in_boston.offense_codes
- seeds.crimes_in_boston.crime

Found 6 models, 12 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 2 seed files, 0 sources

01:36:11 | Concurrency: 1 threads (target='dev')
01:36:11 | 
01:36:11 | 1 of 12 START test not_null_crime_INCIDENT_NUMBER.................... [RUN]
01:36:11 | 1 of 12 PASS not_null_crime_INCIDENT_NUMBER.......................... [PASS in 0.07s]
01:36:11 | 2 of 12 START test not_null_mrt_offense_by_year_count_year........... [RUN]
01:36:11 | 2 of 12 PASS not_null_mrt_offense_by_year_count_year................. [PASS in 0.03s]
01:36:11 | 3 of 12 START test not_null_offense_codes_CODE....................... [RUN]
01:36:11 | 3 of 12 PASS not_null_offense_codes_CODE............................. [PASS in 0.05s]
01:36:11 | 4 of 12 START test not_null_stg_crime_INCIDENT_ID.................... [RUN]
01:36:11 | 4 of 12 PASS not_null_stg_crime_INCIDENT_ID.......................... [PASS in 0.06s]
01:36:11 | 5 of 12 START test not_null_stg_offense_codes_OFFENSE_CODE........... [RUN]
01:36:11 | 5 of 12 PASS not_null_stg_offense_codes_OFFENSE_CODE................. [PASS in 0.04s]
01:36:11 | 6 of 12 START test unique_crime_INCIDENT_NUMBER...................... [RUN]
01:36:11 | 6 of 12 FAIL 27523 unique_crime_INCIDENT_NUMBER...................... [FAIL 27523 in 0.10s]
01:36:11 | 7 of 12 START test unique_mrt_offense_all_count__offense_name_offense_code_group_ [RUN]
01:36:11 | 7 of 12 PASS unique_mrt_offense_all_count__offense_name_offense_code_group_ [PASS in 0.03s]
01:36:11 | 8 of 12 START test unique_mrt_offense_by_year_count_year............. [RUN]
01:36:11 | 8 of 12 FAIL 4 unique_mrt_offense_by_year_count_year................. [FAIL 4 in 0.05s]
01:36:11 | 9 of 12 START test unique_mrt_offense_by_year_month_count__year_month_ [RUN]
01:36:11 | 9 of 12 FAIL 40 unique_mrt_offense_by_year_month_count__year_month_.. [FAIL 40 in 0.06s]
01:36:11 | 10 of 12 START test unique_offense_codes_CODE........................ [RUN]
01:36:11 | 10 of 12 FAIL 150 unique_offense_codes_CODE.......................... [FAIL 150 in 0.04s]
01:36:11 | 11 of 12 START test unique_stg_crime_INCIDENT_ID..................... [RUN]
01:36:12 | 11 of 12 FAIL 27523 unique_stg_crime_INCIDENT_ID..................... [FAIL 27523 in 0.10s]
01:36:12 | 12 of 12 START test unique_stg_offense_codes_OFFENSE_CODE............ [RUN]
01:36:12 | 12 of 12 FAIL 150 unique_stg_offense_codes_OFFENSE_CODE.............. [FAIL 150 in 0.02s]
01:36:12 | 
01:36:12 | Finished running 12 tests in 0.80s.

Completed with 6 errors and 0 warnings:

Failure in test unique_crime_INCIDENT_NUMBER (data/seeds/schema.yml)
  Got 27523 results, expected 0.

  compiled SQL at compiled/compiled/crimes_in_boston/data/seeds/schema.yml/schema_test/unique_crime_INCIDENT_NUMBER.sql

Failure in test unique_mrt_offense_by_year_count_year (models/marts/schema.yml)
  Got 4 results, expected 0.

  compiled SQL at compiled/compiled/crimes_in_boston/models/marts/schema.yml/schema_test/unique_mrt_offense_by_year_count_year.sql

Failure in test unique_mrt_offense_by_year_month_count__year_month_ (models/marts/schema.yml)
  Got 40 results, expected 0.

  compiled SQL at compiled/compiled/crimes_in_boston/models/marts/schema.yml/schema_test/unique_mrt_offense_by_year_month_count__year_month_.sql

Failure in test unique_offense_codes_CODE (data/seeds/schema.yml)
  Got 150 results, expected 0.

  compiled SQL at compiled/compiled/crimes_in_boston/data/seeds/schema.yml/schema_test/unique_offense_codes_CODE.sql

Failure in test unique_stg_crime_INCIDENT_ID (models/staging/schema.yml)
  Got 27523 results, expected 0.

  compiled SQL at compiled/compiled/crimes_in_boston/models/staging/schema.yml/schema_test/unique_stg_crime_INCIDENT_ID.sql

Failure in test unique_stg_offense_codes_OFFENSE_CODE (models/staging/schema.yml)
  Got 150 results, expected 0.

  compiled SQL at compiled/compiled/crimes_in_boston/models/staging/schema.yml/schema_test/unique_stg_offense_codes_OFFENSE_CODE.sql

Done. PASS=6 WARN=0 ERROR=6 SKIP=0 TOTAL=12
```

üëçüèª —Å—á–∏—Ç–∞—é, —Ü–µ–ª—å –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞, —è –Ω–∞—á–∞–ª –∏–∑—É—á–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ `Data Build Tools (dbt)`, –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–æ–Ω—è–ª –∫–∞–∫ —Å—Ç—Ä–æ–∏—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–º–µ–Ω—Ç—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –°–£–ë–î, –Ω–µ–º–Ω–æ–≥–æ —É–∑–Ω–∞–ª –ø—Ä–æ —Ç–µ—Å—Ç—ã... –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç–µ.
